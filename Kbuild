# SPDX-License-Identifier: GPL-2.0

obj-m += vuln_printk_leak.o
obj-m += rust_vuln_printk_leak.o

obj-m += vuln_stack_leak.o
obj-m += vuln_stack_leak_fixed.o
obj-m += rust_vuln_stack_leak.o
obj-m += rust_vuln_stack_leak_fixed.o
obj-m += rust_vuln_stack_leak_v2.o
obj-m += rust_vuln_stack_leak_fixed_v2.o
obj-m += rust_vuln_stack_leak_v3.o

obj-m += vuln_int_ovf.o
obj-m += vuln_int_ovf_fixed.o
obj-m += vuln_int_ovf_v2.o
obj-m += vuln_int_ovf_fixed_v2.o
obj-m += rust_vuln_int_ovf.o
obj-m += rust_vuln_int_ovf_fixed.o
obj-m += rust_vuln_int_ovf_v2_ptr_ptr.o
obj-m += rust_vuln_int_ovf_v2_ptr_cast.o
obj-m += rust_vuln_int_ovf_v2_ptr_slice.o
obj-m += rust_vuln_int_ovf_v2_slice.o
obj-m += rust_vuln_int_ovf_fixed_v2_slice.o

obj-m += vuln_race_device.o
obj-m += vuln_race_device_fixed.o
#obj-m += rust_vuln_race_device_v2_nocompile.o
obj-m += rust_vuln_race_device_v3_atomics.o
obj-m += rust_vuln_race_device_v4_mutex.o
obj-m += rust_vuln_race_device_fixed_v4_mutex.o
obj-m += rust_vuln_race_device_v5_mutex_usize.o
obj-m += rust_vuln_race_device_fixed_v5_mutex_usize.o
obj-m += rust_vuln_race_device_v6_box.o
obj-m += rust_vuln_race_device_fixed_v6_box.o
obj-m += rust_vuln_race_device_v7_box_nosize.o
obj-m += rust_vuln_race_device_fixed_v7_box_nosize.o
obj-m += rust_vuln_race_device_v7_box_nosize_smutex.o
obj-m += rust_vuln_race_device_fixed_v7_box_nosize_smutex.o
obj-m += rust_vuln_race_device_v8_vec.o
obj-m += rust_vuln_race_device_fixed_v8_vec.o
obj-m += rust_vuln_race_device_v9_vec_init.o
obj-m += rust_vuln_race_device_fixed_v9_vec_init.o
obj-m += rust_vuln_race_device_v9_vec_init_smutex.o
obj-m += rust_vuln_race_device_fixed_v9_vec_init_smutex.o

obj-m += vuln_shmem.o
obj-m += rust_vuln_shmem.o
obj-m += rust_vuln_shmem_fixed.o
obj-m += rust_vuln_shmem_v2_plain_deref_doesnt_work.o
obj-m += rust_vuln_shmem_v3_exposed_pages.o
obj-m += rust_vuln_shmem_v4_exposed_area.o

subdir-y += poc
